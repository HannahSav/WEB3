<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ace="http://www.icefaces.org/icefaces/components"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
    <title>Лабораторная 3</title>
    <link rel="shortcut icon" href="https://www.flaticon.com/svg/static/icons/svg/3867/3867043.svg"/>
    <h:outputStylesheet  name="css/head.css"/>
    <h:outputStylesheet  name="css/resultTable.css"/>
    <h:outputStylesheet  name="styles.css"/>
    <h:outputStylesheet  name="css/button.css"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <div class="head">
        Лаба №3
        <br/>Савон Ганна, Салмова Анна, P3231
        <br/>Вариант 2749
    </div>
</h:head>

<h:body>
    <table width="100%">
        <tr>
            <td>
                <h:form id="form">
                    <table class="xyr_in">
                        <tr>
                            <td>
                                <p>Введите координаты Вашего города, чтобы узнать, является ли он свалкой Москвы</p><br/>
                            </td>
                        </tr>
                        <tr class="x_in">
                            <td>
                                <strong class="chooseX">Выберите X:  </strong><h:outputLabel class="xValue" id="xValue"  value="#{Check.x}" />
                                <ace:sliderEntry id="slider_x" value="#{Check.x}" length= "75%" onSlide="change()" min="-4" max="4" stepPercent="12.5">
                                    <ace:ajax render="xValue" event="slide" execute="@this"/>
                                </ace:sliderEntry>
                            </td>
                        </tr>
                        <tr class="textY">
                            <td>
                                <strong class="chooseY">Введите Y от -5 до 5:</strong>
                                <span class="exceptionY"></span>

                                <h:inputText id="y_in" value="#{Check.y}" lemaxlength="25" onchange="change()">
                                    <f:validateDoubleRange minimum="-5.0" maximum="5.0" />
                                </h:inputText>
                            </td>
                        </tr>
                        <tr class="radioR">
                            <td>
                                <label>
                                    <strong class="chooseR"> Выберите радиус глубины познания:</strong> <h:outputLabel class="rValue" id="rValue"  value="#{Check.r/10}" />
                                    <ace:sliderEntry id="slider_r" value="#{Check.r}" axis="2.0" length="75%" onSlide="change()" min="20" max="50" stepPercent="2.5">
                                        <ace:ajax render="rValue" event="slide" execute="@this"/>
                                    </ace:sliderEntry>
                                    <!--h:inputHidden id="r_value"  value="#{Check.r}"/-->
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td class="send_but">
                                <h:commandButton class = "button" id="send" value="Отправить" action="#{Check.newPoint()}">
                                    <f:ajax execute="@form" render="ajaxTable" />
                                </h:commandButton>
                            </td>
                        </tr>
                    </table>
                </h:form>
            </td>
            <td width="33%">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="400" height="400" id="graph" class="graph" onclick="clickGraph()">
                    <!--главный квадрат-->
                    <rect id="rect" height="400" width="400" fill="#FFF0F0" opacity="0.9"></rect>

                    <line class="axes" x1="0" x2="400" y1="200" y2="200" stroke="black"></line>
                    <line x1="200" x2="200" y1="0" y2="400" stroke="black"></line>
                    <polygon points="200,0 194,25 206,25" stroke="black"></polygon>
                    <polygon points="400,200 375,206 375,194" stroke="black"></polygon>

                    <line x1="260" x2="260" y1="205" y2="195" stroke="black"></line>
                    <line x1="320" x2="320" y1="205" y2="195" stroke="black"></line>

                    <line x1="80"  x2="80"  y1="205" y2="195" stroke="black"></line>
                    <line x1="140" x2="140" y1="205" y2="195" stroke="black"></line>

                   <line x1="195" x2="205" y1="140" y2="140" stroke="black"></line>
                    <line x1="195" x2="205" y1="80"  y2="80"  stroke="black"></line>

                    <line x1="195" x2="205" y1="260" y2="260" stroke="black"></line>
                    <line x1="195" x2="205" y1="320" y2="320" stroke="black"></line>

                    <text x="250" y="190">R/2</text>
                    <text x="315" y="190">R</text>

                    <text x="70" y="190">-R</text>
                    <text x="125" y="190">-R/2</text>

                    <text x="210" y="145">R/2</text>
                    <text x="210" y="85">R</text>

                    <text x="210" y="265">-R/2</text>
                    <text x="210" y="325">-R</text>

                    <polygon points="140,200 140,80 200,80, 200,200" fill="purple" fill-opacity="0.3" stroke="purple"></polygon>

                    <path d="M 260 200 A 70 70, 0, 0, 1, 200 260 L 200 200 Z" fill="purple" fill-opacity="0.3" stroke="purple"></path>

                    <polygon points="140,200 200,200 200,260" fill="purple" fill-opacity="0.3" stroke="purple"></polygon>

                    <circle r="3" cx="200" cy="200" id="point" fill="black" ></circle>
                </svg>
            </td>
            <td>
                <div style="height:350px;overflow:auto;width: 320px">
                <h:panelGroup id="ajaxTable">
                    <ui:repeat value="#{Check.points}" var="point">
                        <h:outputScript>
                            var x = "#{point.x}";
                            var y = "#{point.y}";
                            var r = "#{point.r}";
                            drawPoints(x, y, r);
                        </h:outputScript>
                    </ui:repeat>

                    <h:dataTable value="#{Check.points}" var="point" styleClass="result" cellspacing="0" headerClass="result_head">
                        <h:column>
                            <f:facet name="header">X</f:facet>
                            #{point.x}
                        </h:column>
                        <h:column>
                            <f:facet name="header">Y</f:facet>
                            #{point.y}
                        </h:column>
                        <h:column>
                            <f:facet name="header">R</f:facet>
                            #{point.r}
                        </h:column>
                        <h:column>
                            <f:facet name="header">HIT</f:facet>
                            #{point.hit}
                        </h:column>
                        <h:column>
                            <f:facet name="header">TIME</f:facet>
                            #{point.time}
                        </h:column>
                        <h:column>
                            <f:facet name="header">RUNTIME</f:facet>
                            #{point.runtime}
                        </h:column>
                    </h:dataTable>
                </h:panelGroup>
                </div>
                <h:button class = "button" id="toStart" value="На стартовую" outcome="toStart">
                </h:button>
            </td>
        </tr>
    </table>
</h:body>
<script type="text/javascript" src="resources/scripts/script.js"></script>
<script type="text/javascript" src="resources/scripts/map.js"></script>
</html>